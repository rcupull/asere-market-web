import{k as C,j as e,I as _,H as w,J as B,n as I,i as p,K as S,r as M,b as G,u as R,g as q,M as H,h as J,F as K,O as l,t as Q,B as O,f as W,w as X,v as Y,P as Z,Q as $,x as ee,y as se,S as re}from"./index-OtumRKpY.js";import{M as oe}from"./index-ftY_1bKV.js";import{F as te,a as ae}from"./index-HMjjI6RW.js";import{u as me,F as ne}from"./useAddManyImages-7DbR3ONc.js";import{u as ie,F as ue,A as le,a as ce}from"./index-k1E1uZUa.js";import{F as T}from"./index-HEeqd90A.js";import{u as de}from"./index-QVyCw3xz.js";import{F as fe}from"./index-2t3GpseM.js";import{u as be,a as pe}from"./index-UHCz05Wr.js";import"./description-xrSyH_28.js";import"./radio-group-K5LnY2sP.js";import"./label-IraI5jSS.js";import"./form-gCruAkS1.js";import"./index-zX2RDtHZ.js";import"./CheckIcon-5k25d-5i.js";const Ne=({label:r,...a})=>{var s,n;const{business:o}=C(),m=((n=(s=o==null?void 0:o.layouts)==null?void 0:s.posts)==null?void 0:n.sections)||[],i=de();return e.jsxDEV(T,{label:e.jsxDEV("div",{className:"flex items-center",children:[r,e.jsxDEV(_,{title:"Agregar nuevo grupo de publicaciones",className:"text-green-600 font-bold ml-2",onClick:t=>{t.preventDefault(),t.stopPropagation(),i.open()}},void 0,!1,{fileName:"/Users/mac/Documents/work/asere-market/asere-market-web/src/components/field-posts-section-select/index.tsx",lineNumber:23,columnNumber:11},void 0)]},void 0,!0,{fileName:"/Users/mac/Documents/work/asere-market/asere-market-web/src/components/field-posts-section-select/index.tsx",lineNumber:21,columnNumber:9},void 0),multi:!0,renderOption:({name:t})=>t,renderValue:({name:t})=>e.jsxDEV("div",{className:"px-2 mx-0.5 rounded-2xl border border-gray-400",children:t},void 0,!1,{fileName:"/Users/mac/Documents/work/asere-market/asere-market-web/src/components/field-posts-section-select/index.tsx",lineNumber:37,columnNumber:9},void 0),optionToValue:({id:t})=>t,items:m.map(({_id:t,name:u})=>({id:t,name:u})),...a},void 0,!1,{fileName:"/Users/mac/Documents/work/asere-market/asere-market-web/src/components/field-posts-section-select/index.tsx",lineNumber:19,columnNumber:5},void 0)},ke=({className:r,label:a,collapsable:o,...m})=>{const{field:i,error:s}=w(m),{getFieldName:n}=ie({field:i,initialValues:{shoppingMethod:void 0}}),t=e.jsxDEV("div",{className:"flex flex-col justify-around h-full px-6 gap-2",children:[e.jsxDEV(ue,{label:"Contacto",name:n("shoppingMethod")},void 0,!1,{fileName:"/Users/mac/Documents/work/asere-market/asere-market-web/src/components/field-post-page-layout/index.tsx",lineNumber:36,columnNumber:7},void 0),e.jsxDEV(Ne,{label:"Grupos de publicaciones similares",name:n("postsSectionsBelowIds"),className:"mt-6"},void 0,!1,{fileName:"/Users/mac/Documents/work/asere-market/asere-market-web/src/components/field-post-page-layout/index.tsx",lineNumber:38,columnNumber:7},void 0)]},void 0,!0,{fileName:"/Users/mac/Documents/work/asere-market/asere-market-web/src/components/field-post-page-layout/index.tsx",lineNumber:35,columnNumber:5},void 0);return e.jsxDEV(B,{label:a,error:s,className:I(r),children:o?e.jsxDEV(le,{header:"Abrir",children:t},void 0,!1,{fileName:"/Users/mac/Documents/work/asere-market/asere-market-web/src/components/field-post-page-layout/index.tsx",lineNumber:47,columnNumber:22},void 0):t},void 0,!1,{fileName:"/Users/mac/Documents/work/asere-market/asere-market-web/src/components/field-post-page-layout/index.tsx",lineNumber:46,columnNumber:5},void 0)},we=({label:r,...a})=>{const{field:o}=w(a);return e.jsxDEV(p,{...a,disabled:!S(o.value),label:e.jsxDEV("div",{className:"flex items-center gap-2",children:[r,e.jsxDEV(fe,{noUseFormik:!0,value:S(o.value),onChange:m=>{o.onChange({target:{name:o.name,value:m.target.checked?0:null}})}},void 0,!1,{fileName:"/Users/mac/Documents/work/asere-market/asere-market-web/src/components/field-post-stock-amount/index.tsx",lineNumber:20,columnNumber:11},void 0)]},void 0,!0,{fileName:"/Users/mac/Documents/work/asere-market/asere-market-web/src/components/field-post-stock-amount/index.tsx",lineNumber:18,columnNumber:9},void 0),type:"number"},void 0,!1,{fileName:"/Users/mac/Documents/work/asere-market/asere-market-web/src/components/field-post-stock-amount/index.tsx",lineNumber:14,columnNumber:5},void 0)},A=M.forwardRef((r,a)=>{const{className:o,label:m,...i}=r,{field:s,error:n}=w(r);return e.jsxDEV(B,{label:m,error:n,className:o,children:e.jsxDEV("textarea",{ref:a,className:I("block w-full rounded-md border-0 py-1.5 text-gray-900 shadow-sm ring-1 ring-inset ring-gray-300 placeholder:text-gray-400 focus:ring-2 focus:ring-inset focus:ring-indigo-600 sm:text-sm sm:leading-6",{"ring-1 rounded-md ring-red-500 focus:ring-red-500":!!n}),...i,...s},void 0,!1,{fileName:"/Users/mac/Documents/work/asere-market/asere-market-web/src/components/field-text-area/index.tsx",lineNumber:20,columnNumber:7},void 0)},void 0,!1,{fileName:"/Users/mac/Documents/work/asere-market/asere-market-web/src/components/field-text-area/index.tsx",lineNumber:19,columnNumber:5},void 0)}),xe=()=>{const r=G(),{authData:a}=R(),o=(a==null?void 0:a.user._id)||"<unknow user>";return{addOnePost:{data:r[0],status:r[1],fetch:(m,i={})=>{r[2]({method:"post",url:q({path:"/posts",urlParams:{userId:o}}),data:m},i)},reset:r[3]}}},De=({business:r,portal:a,onAfterSuccess:o,post:m})=>{const{routeName:i,postFormFields:s=[]}=r,{addOnePost:n}=xe(),{updateOnePost:t}=be(),{userPlan:u}=H(),{addManyImages:d}=me(),N=J();return e.jsxDEV(K,{initialValues:{name:"",price:0,currency:"CUP",details:"",description:"",colors:[],clothingSizes:[],images:[],postCategoriesTags:[],postPageLayout:void 0,stockAmount:null,...m||{}},enableReinitialize:!0,validate:f=>N(f,[{field:"name",type:"required"}]),onSubmit:()=>{},children:({values:f,isValid:k})=>e.jsxDEV("form",{children:[e.jsxDEV(e.Fragment,{children:[e.jsxDEV(p,{name:"name",label:"Nombre del producto"},void 0,!1,{fileName:"/Users/mac/Documents/work/asere-market/asere-market-web/src/features/modal/components/post-new/PostForm.tsx",lineNumber:85,columnNumber:15},void 0),e.jsxDEV(l,{},void 0,!1,{fileName:"/Users/mac/Documents/work/asere-market/asere-market-web/src/features/modal/components/post-new/PostForm.tsx",lineNumber:86,columnNumber:15},void 0)]},void 0,!0,{fileName:"/Users/mac/Documents/work/asere-market/asere-market-web/src/features/modal/components/post-new/PostForm.tsx",lineNumber:84,columnNumber:13},void 0),s.includes("description")&&e.jsxDEV(e.Fragment,{children:[e.jsxDEV(A,{label:"Descripción",name:"description",rows:3,className:"mt-6"},void 0,!1,{fileName:"/Users/mac/Documents/work/asere-market/asere-market-web/src/features/modal/components/post-new/PostForm.tsx",lineNumber:91,columnNumber:17},void 0),e.jsxDEV(l,{},void 0,!1,{fileName:"/Users/mac/Documents/work/asere-market/asere-market-web/src/features/modal/components/post-new/PostForm.tsx",lineNumber:92,columnNumber:17},void 0)]},void 0,!0,{fileName:"/Users/mac/Documents/work/asere-market/asere-market-web/src/features/modal/components/post-new/PostForm.tsx",lineNumber:90,columnNumber:15},void 0),s.includes("details")&&e.jsxDEV(e.Fragment,{children:[e.jsxDEV(A,{id:"post_details",name:"details",label:"Detalles del producto",className:"mt-6",rows:3},void 0,!1,{fileName:"/Users/mac/Documents/work/asere-market/asere-market-web/src/features/modal/components/post-new/PostForm.tsx",lineNumber:98,columnNumber:17},void 0),e.jsxDEV(l,{},void 0,!1,{fileName:"/Users/mac/Documents/work/asere-market/asere-market-web/src/features/modal/components/post-new/PostForm.tsx",lineNumber:105,columnNumber:17},void 0)]},void 0,!0,{fileName:"/Users/mac/Documents/work/asere-market/asere-market-web/src/features/modal/components/post-new/PostForm.tsx",lineNumber:97,columnNumber:15},void 0),e.jsxDEV(e.Fragment,{children:[e.jsxDEV(ne,{label:"Imagen",id:"images",name:"images",className:"mt-6",getImageSrc:Q,multi:!0,max:u==null?void 0:u.maxImagesByPosts},void 0,!1,{fileName:"/Users/mac/Documents/work/asere-market/asere-market-web/src/features/modal/components/post-new/PostForm.tsx",lineNumber:111,columnNumber:15},void 0),e.jsxDEV(l,{},void 0,!1,{fileName:"/Users/mac/Documents/work/asere-market/asere-market-web/src/features/modal/components/post-new/PostForm.tsx",lineNumber:120,columnNumber:15},void 0)]},void 0,!0,{fileName:"/Users/mac/Documents/work/asere-market/asere-market-web/src/features/modal/components/post-new/PostForm.tsx",lineNumber:110,columnNumber:13},void 0),e.jsxDEV(e.Fragment,{children:[e.jsxDEV(ce,{label:"Categorías",name:"postCategoriesTags",className:"mt-6"},void 0,!1,{fileName:"/Users/mac/Documents/work/asere-market/asere-market-web/src/features/modal/components/post-new/PostForm.tsx",lineNumber:125,columnNumber:15},void 0),e.jsxDEV(l,{},void 0,!1,{fileName:"/Users/mac/Documents/work/asere-market/asere-market-web/src/features/modal/components/post-new/PostForm.tsx",lineNumber:130,columnNumber:15},void 0)]},void 0,!0,{fileName:"/Users/mac/Documents/work/asere-market/asere-market-web/src/features/modal/components/post-new/PostForm.tsx",lineNumber:124,columnNumber:13},void 0),(s.includes("price")||s.includes("currency")||s.includes("discount")||s.includes("stockAmount"))&&e.jsxDEV(e.Fragment,{children:[e.jsxDEV("div",{className:"flex flex-col sm:flex-row items-center gap-6",children:[e.jsxDEV(p,{id:"post_price",name:"price",label:"Precio",type:"number",className:"mt-6 w-full"},void 0,!1,{fileName:"/Users/mac/Documents/work/asere-market/asere-market-web/src/features/modal/components/post-new/PostForm.tsx",lineNumber:139,columnNumber:19},void 0),e.jsxDEV(T,{items:[{currency:"CUP"},{currency:"MLC"},{currency:"USD"}],renderOption:({currency:c})=>c,renderValue:({currency:c})=>c,optionToValue:({currency:c})=>c,name:"currency",label:"Moneda",className:"mt-6 w-full"},void 0,!1,{fileName:"/Users/mac/Documents/work/asere-market/asere-market-web/src/features/modal/components/post-new/PostForm.tsx",lineNumber:147,columnNumber:19},void 0),s.includes("discount")&&e.jsxDEV(p,{id:"post_discount",name:"discount",label:"Descuento",type:"number",className:"mt-6 w-full"},void 0,!1,{fileName:"/Users/mac/Documents/work/asere-market/asere-market-web/src/features/modal/components/post-new/PostForm.tsx",lineNumber:168,columnNumber:21},void 0),s.includes("stockAmount")&&e.jsxDEV(we,{id:"post_stockAmount",name:"stockAmount",label:"Disponibilidad",className:"mt-6 w-full"},void 0,!1,{fileName:"/Users/mac/Documents/work/asere-market/asere-market-web/src/features/modal/components/post-new/PostForm.tsx",lineNumber:178,columnNumber:21},void 0)]},void 0,!0,{fileName:"/Users/mac/Documents/work/asere-market/asere-market-web/src/features/modal/components/post-new/PostForm.tsx",lineNumber:138,columnNumber:17},void 0),e.jsxDEV(l,{},void 0,!1,{fileName:"/Users/mac/Documents/work/asere-market/asere-market-web/src/features/modal/components/post-new/PostForm.tsx",lineNumber:186,columnNumber:17},void 0)]},void 0,!0,{fileName:"/Users/mac/Documents/work/asere-market/asere-market-web/src/features/modal/components/post-new/PostForm.tsx",lineNumber:137,columnNumber:15},void 0),s.includes("colors")&&e.jsxDEV(e.Fragment,{children:[e.jsxDEV(te,{label:"Colores",name:"colors",className:"mt-6",multi:!0},void 0,!1,{fileName:"/Users/mac/Documents/work/asere-market/asere-market-web/src/features/modal/components/post-new/PostForm.tsx",lineNumber:192,columnNumber:17},void 0),e.jsxDEV(l,{},void 0,!1,{fileName:"/Users/mac/Documents/work/asere-market/asere-market-web/src/features/modal/components/post-new/PostForm.tsx",lineNumber:193,columnNumber:17},void 0)]},void 0,!0,{fileName:"/Users/mac/Documents/work/asere-market/asere-market-web/src/features/modal/components/post-new/PostForm.tsx",lineNumber:191,columnNumber:15},void 0),s.includes("clothingSizes")&&e.jsxDEV(e.Fragment,{children:[e.jsxDEV(ae,{label:"Tallas",name:"clothingSizes",className:"mt-6",multi:!0},void 0,!1,{fileName:"/Users/mac/Documents/work/asere-market/asere-market-web/src/features/modal/components/post-new/PostForm.tsx",lineNumber:199,columnNumber:17},void 0),e.jsxDEV(l,{},void 0,!1,{fileName:"/Users/mac/Documents/work/asere-market/asere-market-web/src/features/modal/components/post-new/PostForm.tsx",lineNumber:205,columnNumber:17},void 0)]},void 0,!0,{fileName:"/Users/mac/Documents/work/asere-market/asere-market-web/src/features/modal/components/post-new/PostForm.tsx",lineNumber:198,columnNumber:15},void 0),s.includes("postPageLayout")&&e.jsxDEV(e.Fragment,{children:[e.jsxDEV(ke,{label:"Diseño de la página de la publicación",name:"postPageLayout",className:"w-full"},void 0,!1,{fileName:"/Users/mac/Documents/work/asere-market/asere-market-web/src/features/modal/components/post-new/PostForm.tsx",lineNumber:211,columnNumber:17},void 0),e.jsxDEV(l,{},void 0,!1,{fileName:"/Users/mac/Documents/work/asere-market/asere-market-web/src/features/modal/components/post-new/PostForm.tsx",lineNumber:216,columnNumber:17},void 0)]},void 0,!0,{fileName:"/Users/mac/Documents/work/asere-market/asere-market-web/src/features/modal/components/post-new/PostForm.tsx",lineNumber:210,columnNumber:15},void 0),a.getPortal(e.jsxDEV(O,{label:"Guardar",isBusy:n.status.isBusy||t.status.isBusy,disabled:!k,onClick:()=>{const{images:c,currency:x,description:D,name:g,price:v,clothingSizes:F,colors:U,details:P,postCategoriesTags:z,discount:E,postPageLayout:V,stockAmount:j}=f,h=b=>{const{_id:y}=b;d.fetch({images:c,routeName:i,postId:y,userId:b.createdBy},{onAfterSuccess:L=>{t.fetch({postId:y,images:L,currency:x,description:D,name:g,price:v,clothingSizes:F,colors:U,details:P,postCategoriesTags:z,discount:E,postPageLayout:V,stockAmount:j},{onAfterSuccess:o})}})};m?h(m):(()=>{n.fetch({currency:x,description:D,name:g,price:v,clothingSizes:F,colors:U,details:P,routeName:i,images:[],discount:E,postPageLayout:V,stockAmount:j},{onAfterSuccess:b=>{h(b)}})})()},variant:"primary",className:"w-full"},void 0,!1,{fileName:"/Users/mac/Documents/work/asere-market/asere-market-web/src/features/modal/components/post-new/PostForm.tsx",lineNumber:221,columnNumber:15},void 0))]},void 0,!0,{fileName:"/Users/mac/Documents/work/asere-market/asere-market-web/src/features/modal/components/post-new/PostForm.tsx",lineNumber:82,columnNumber:11},void 0)},void 0,!1,{fileName:"/Users/mac/Documents/work/asere-market/asere-market-web/src/features/modal/components/post-new/PostForm.tsx",lineNumber:54,columnNumber:5},void 0)},Oe=({postId:r,callAfarResources:a})=>{const o=W(),{onClose:m}=X(),i=pe(),{onCallAfar:s}=Y(),n=()=>s(a),t=()=>{n(),m()},{getOnePost:u}=Z(),{business:d,onFetch:N,status:f}=C();M.useEffect(()=>{r&&u.fetch({id:r})},[]);const k=()=>u.status.isBusy||f.isBusy?e.jsxDEV("div",{className:"h-40 flex justify-center items-center",children:e.jsxDEV(re,{},void 0,!1,{fileName:"/Users/mac/Documents/work/asere-market/asere-market-web/src/features/modal/components/post-new/index.tsx",lineNumber:53,columnNumber:11},void 0)},void 0,!1,{fileName:"/Users/mac/Documents/work/asere-market/asere-market-web/src/features/modal/components/post-new/index.tsx",lineNumber:52,columnNumber:9},void 0):d?e.jsxDEV(De,{business:d,portal:o,onAfterSuccess:t,post:u.data},void 0,!1,{fileName:"/Users/mac/Documents/work/asere-market/asere-market-web/src/features/modal/components/post-new/index.tsx",lineNumber:63,columnNumber:7},void 0):e.jsxDEV(e.Fragment,{},void 0,!1,{fileName:"/Users/mac/Documents/work/asere-market/asere-market-web/src/features/modal/components/post-new/index.tsx",lineNumber:59,columnNumber:14},void 0);return e.jsxDEV(oe,{title:e.jsxDEV("div",{className:"flex items-center justify-between",children:[r?"Editar publicación":"Nueva publicación",e.jsxDEV(O,{variant:"link",svg:$,label:"Editar campos del formulario",onClick:()=>i.open({onAfterSuccess:()=>{d&&N({routeName:d.routeName})}})},void 0,!1,{fileName:"/Users/mac/Documents/work/asere-market/asere-market-web/src/features/modal/components/post-new/index.tsx",lineNumber:77,columnNumber:11},void 0)]},void 0,!0,{fileName:"/Users/mac/Documents/work/asere-market/asere-market-web/src/features/modal/components/post-new/index.tsx",lineNumber:75,columnNumber:9},void 0),content:k(),badge:e.jsxDEV(ee,{variant:"info"},void 0,!1,{fileName:"/Users/mac/Documents/work/asere-market/asere-market-web/src/features/modal/components/post-new/index.tsx",lineNumber:93,columnNumber:14},void 0),primaryBtn:e.jsxDEV("div",{ref:o.ref},void 0,!1,{fileName:"/Users/mac/Documents/work/asere-market/asere-market-web/src/features/modal/components/post-new/index.tsx",lineNumber:94,columnNumber:19},void 0),secondaryBtn:e.jsxDEV(se,{},void 0,!1,{fileName:"/Users/mac/Documents/work/asere-market/asere-market-web/src/features/modal/components/post-new/index.tsx",lineNumber:95,columnNumber:21},void 0)},void 0,!1,{fileName:"/Users/mac/Documents/work/asere-market/asere-market-web/src/features/modal/components/post-new/index.tsx",lineNumber:73,columnNumber:5},void 0)};export{Oe as PostNew};
