import{r as c,w as q,H as W,j as r,J as _,n as k,p as H,a_ as $,aF as z,a$ as K,K as Z,aZ as Q,G as j,aJ as V,b as X,g as Y}from"./index-ih0eSx80.js";function ee({title:n,titleId:d,...f},i){return c.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true","data-slot":"icon",ref:i,"aria-labelledby":d},f),n?c.createElement("title",{id:d},n):null,c.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M12 4.5v15m7.5-7.5h-15"}))}const te=c.forwardRef(ee),re=te,L=n=>{const d=URL.createObjectURL(n);return new Promise(f=>{const i=new globalThis.Image;i.src=d,i.onload=()=>{f({height:i.height,width:i.width})}})},ae=c.forwardRef((n,d)=>{var T,A;const{className:f,label:i,multi:P,max:w,getImageSrc:x,enabledImageHref:u,...h}=n,{pushModal:y}=q(),{field:o,error:O}=W(n),{value:C}=o,[g,N]=c.useState([]),[l,F]=c.useState([void 0]),[a,b]=c.useState(0),p=e=>Z(w)&&w<=I(e).length,E=e=>p(e)?e:[...e,void 0],U=e=>e.src instanceof File?URL.createObjectURL(e.src):typeof e.src=="string"&&(x==null?void 0:x(e.src))||"",v=c.useMemo(()=>{const e=l[a];if(e)return e},[a,l]);c.useEffect(()=>{if(C!==g){const e=C||[];N(e);const t=E(e);F(t),b(0)}},[C,w]);const I=e=>Q(e,t=>!!(t!=null&&t.src)),B=async(e,t)=>{let s=[...l];switch(t){case"add":{if(!e)return;e instanceof File?s=j(s,{src:e,...await L(e)},a):s=j(s,e,a),s=E(s),b(s.length-1);break}case"remove":{s=V(s,a),b(a?a-1:0);break}case"change":{if(!e)return;e instanceof File?s=j(s,{...s[a],src:e,...await L(e)},a):s=j(s,{...s[a],...e},a);break}}F(s);const m=I(s);N(m),o.onChange({target:{name:o.name,value:m}})},G=async e=>{let t=[...l];t.pop();const s=async(R,D,M)=>{const S=D[M];S instanceof File?R.push({src:S,...await L(S)}):R.push(S),M<D.length-1&&await s(R,D,M+1)};await s(t,e,0),t=E(t),b(t.length-1),F(t);const m=I(t);N(m),o.onChange({target:{name:o.name,value:m}})},J=e=>{let t=[...l];const s=t[a];if(s){t=j(t,{...s,href:e},a),F(t);const m=I(t);N(m),o.onChange({target:{name:o.name,value:m}})}};return r.jsxs(_,{label:i,error:O,className:f,children:[P&&r.jsxs("div",{className:"flex items-center justify-start gap-2 mb-1",children:[l==null?void 0:l.map((e,t)=>{const s=t===a;return r.jsx("div",{className:k("h-8 w-10 cursor-pointer",{"border-gray-700 border-2 rounded-md p-0.5":s}),onClick:()=>b(t),children:e?r.jsx("img",{src:U(e),className:"h-full w-full"}):r.jsxs("div",{className:"relative h-full w-full text-gray-500",children:[r.jsx(H,{className:"h-full w-full"},t),r.jsx(re,{className:"h-4 w-4 absolute top-1/2 left-1/2 -translate-x-1/2 -translate-y-1/2 text-gray-600 font-bold"})]})},t)}),p(g)&&r.jsx("div",{className:"border-2 border-gray-300 rounded-md h-8 w-10 flex items-center justify-center",children:r.jsx($,{})})]}),r.jsx("div",{className:k("relative h-48",{"ring-1 rounded-md ring-red-500 focus:ring-red-500":!!O}),onDragOver:e=>{e.preventDefault()},onDrop:e=>{if(e.preventDefault(),p(g))return;const t=Array.from(e.dataTransfer.files);G(t)},children:v?r.jsxs(r.Fragment,{children:[r.jsx("img",{src:U(v),width:v.width,height:v.height,className:"object-contain w-full h-full border-2 p-2 border-dashed border-gray-300"}),r.jsx(z,{className:"!absolute top-1 right-0",onClick:e=>{e.preventDefault(),B(null,"remove")}})]}):r.jsx("div",{className:"flex justify-center rounded-lg border border-dashed border-gray-900/25 px-6 py-10",children:r.jsxs("div",{className:"text-center",children:[r.jsx(H,{className:"mx-auto h-12 w-12 text-gray-300"}),r.jsxs("div",{className:"mt-4 flex text-sm leading-6 text-gray-600",children:[r.jsxs("label",{htmlFor:o.name,className:k("relative cursor-pointer rounded-md bg-white font-semibold text-indigo-600 focus-within:outline-none focus-within:ring-2 focus-within:ring-indigo-600 focus-within:ring-offset-2 hover:text-indigo-500",{"!cursor-not-allowed":p(g)}),children:[r.jsx("span",{children:"Suba una imagen"}),r.jsx("input",{ref:d,type:"file",className:"sr-only",accept:"image/*",disabled:p(g),...h,...o,value:"",onChange:e=>{var t;B((t=e.target.files)==null?void 0:t[0],a===l.length-1?"add":"change")}})]}),r.jsx("p",{className:"px-1",children:",arrastre y suelte"}),r.jsx("p",{className:k("relative cursor-pointer rounded-md bg-white font-semibold text-indigo-600 focus-within:outline-none focus-within:ring-2 focus-within:ring-indigo-600 focus-within:ring-offset-2 hover:text-indigo-500",{"!cursor-not-allowed":p(g)}),onClick:()=>{p(g)||y("CatalogsSearchImage",{onSelected:e=>G(e),multi:!0},{emergent:!0})},children:"o busque en nuestros catÃ¡logos"})]}),r.jsx("p",{className:"text-xs leading-5 text-gray-600",children:"PNG, JPG, GIF up to 10MB"})]})})}),v&&u&&r.jsxs("div",{className:"flex items-center mt-2",children:[r.jsx(K,{placeholder:"Escriba la url promocional de esta imagen del banner (opcional). Ejemplo: https://example.com",value:((T=l[a])==null?void 0:T.href)||"",onChange:e=>{e.preventDefault(),J(e.target.value)}}),r.jsx("a",{href:((A=l[a])==null?void 0:A.href)||"",className:"text-nowrap ml-2 hyperlink",target:"_blank",rel:"noreferrer",children:"Ir al link"})]})]})}),ne=()=>{const n=X();return{addManyImages:{data:n[0],status:n[1],fetch:({images:d,userId:f,postId:i,routeName:P},w={})=>{const x=d.map(u=>new Promise(h=>{if(u.src instanceof File){const y=new FormData;y.append("image",u.src),n[2]({method:"post",url:Y({path:"/images",query:{userId:f,routeName:P,postId:i}}),data:y,headers:{"Content-Type":"multipart/form-data"}},{onAfterSuccess:o=>{h({...u,src:o.imageSrc})}})}else h(u)}));Promise.all(x).then(u=>{const{onAfterSuccess:h}=w||{};h==null||h(u)})},reset:n[3]}}};export{ae as F,ne as u};
