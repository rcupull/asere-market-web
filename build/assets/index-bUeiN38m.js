import{r as l,j as e,n as E,C as F,w as v,v as O,s as k,T as A,D as R,f as M,h as S,F as G,U as c,i as P,q as u,B as V,x as q,y as I}from"./index-ih0eSx80.js";import{F as L}from"./index-Z1FoIn4o.js";import{M as T}from"./index-gmqFlRPh.js";import{u as D}from"./useAddOneBusiness-fln7KMR9.js";import{u as U}from"./useUpdateOneBusiness-pno-eXXt.js";import"./form-Ycfp73ce.js";import"./CheckIcon-GmkBleVb.js";import"./description-8TzrVJh3.js";function X({title:a,titleId:t,...o},n){return l.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true","data-slot":"icon",ref:n,"aria-labelledby":t},o),a?l.createElement("title",{id:t},a):null,l.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"m9.75 9.75 4.5 4.5m0-4.5-4.5 4.5M21 12a9 9 0 1 1-18 0 9 9 0 0 1 18 0Z"}))}const z=l.forwardRef(X),W=z,Z=({routeName:a,error:t,className:o})=>{const n=t?e.jsx(W,{className:"text-red-500 w-5 h-5"}):e.jsx(F,{className:"text-green-500 w-5 h-5"});return e.jsx("div",{className:o,children:a&&e.jsxs("div",{className:"flex items-center",children:[n,e.jsx("span",{className:"text-sm ml-1",children:"Ruta de la página:"}),e.jsx("span",{className:E("text-sm ml-1",{"text-red-500":t,"text-green-500":!t}),children:a})]})})},se=({callAfarResources:a,routeName:t})=>{const{onClose:o}=v(),{onCallAfar:n}=O(),{getAllBusiness:y}=k(),{addOneBusiness:x}=D(),{updateOneBusiness:j}=U(),{getOneBusiness:p}=A(),r=p.data;l.useEffect(()=>{t&&p.fetch({routeName:t})},[]);const B=R(),b=M(),N=S(),h="Ese nombre de negocio ya existe.",C=e.jsx(G,{initialValues:{category:"",name:"",...r||{}},enableReinitialize:!0,validate:d=>N(d,[{field:"category",type:"required"},{field:"name",type:"required"},{field:"name",type:"custom",message:h,customCb:async i=>{const f=c(i);return new Promise(s=>{B(()=>{y.fetch({routeNames:[f]},{onAfterSuccess:m=>{const{data:g}=m,w=!!g.length;s(!w)}})},500)})}}]),onSubmit:()=>{},children:({errors:d,values:i,isValid:f})=>e.jsxs("form",{children:[e.jsx(P,{id:"business-name",name:"name",autoComplete:"business-name",label:"Nombre del negocio"}),e.jsx(Z,{routeName:c(i.name),error:h===d.name,className:"mt-3"}),!r&&e.jsx(L,{items:[{category:"food",label:u("food")},{category:"clothing",label:u("clothing")},{category:"service",label:u("service")},{category:"tool",label:u("tool")}],renderOption:({label:s})=>s,renderValue:({label:s})=>s,optionToValue:({category:s})=>s,name:"category",label:"Categoría",className:"mt-6"}),b.getPortal(e.jsx(V,{label:"Guardar",isBusy:x.status.isBusy,disabled:!f,onClick:()=>{if(r){const{name:s}=i;j.fetch({routeName:r.routeName,update:{name:s,routeName:c(s)}},{onAfterSuccess:()=>{o(),n(a,{...r,name:s,routeName:c(s)})}})}else{const{category:s,name:m}=i;x.fetch({category:s,name:m,routeName:c(m)},{onAfterSuccess:g=>{o(),n(a,g)}})}},variant:"primary",className:"w-full"}))]})});return e.jsx(T,{title:r?"Editar negocio":"Crear negocio",content:C,badge:e.jsx(q,{variant:"info"}),primaryBtn:e.jsx("div",{ref:b.ref}),secondaryBtn:e.jsx(I,{})})};export{se as BusinessNew};
