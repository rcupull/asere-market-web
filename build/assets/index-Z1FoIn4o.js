import{r as u,aL as ne,aj as F,ak as ae,X as N,Y as M,W as g,a1 as E,aq as me,aM as he,aN as Oe,a5 as q,a6 as W,aO as Re,an as H,a7 as Se,a8 as ye,aP as Le,a9 as A,al as J,aQ as we,am as Ie,aR as $e,aS as Pe,aT as Te,aU as $,at as S,au as Ce,ai as Z,aV as ke,aW as Ee,H as De,aX as D,j as y,J as je,n as j,aY as Fe,av as Ne,aK as X,aJ as Me,aZ as Ae}from"./index-ih0eSx80.js";import{T as Ue,e as Be}from"./form-Ycfp73ce.js";import{C as Qe}from"./CheckIcon-GmkBleVb.js";function re(e,r){let[o,n]=u.useState(e),i=ne(e);return F(()=>n(i.current),[i,n,...r]),o}var Ve=(e=>(e[e.Open=0]="Open",e[e.Closed=1]="Closed",e))(Ve||{}),We=(e=>(e[e.Single=0]="Single",e[e.Multi=1]="Multi",e))(We||{}),ze=(e=>(e[e.Pointer=0]="Pointer",e[e.Other=1]="Other",e))(ze||{}),qe=(e=>(e[e.OpenListbox=0]="OpenListbox",e[e.CloseListbox=1]="CloseListbox",e[e.GoToOption=2]="GoToOption",e[e.Search=3]="Search",e[e.ClearSearch=4]="ClearSearch",e[e.RegisterOption=5]="RegisterOption",e[e.UnregisterOption=6]="UnregisterOption",e[e.RegisterLabel=7]="RegisterLabel",e))(qe||{});function Y(e,r=o=>o){let o=e.activeOptionIndex!==null?e.options[e.activeOptionIndex]:null,n=Ee(r(e.options.slice()),c=>c.dataRef.current.domRef.current),i=o?n.indexOf(o):null;return i===-1&&(i=null),{options:n,activeOptionIndex:i}}let He={1(e){return e.dataRef.current.disabled||e.listboxState===1?e:{...e,activeOptionIndex:null,listboxState:1}},0(e){if(e.dataRef.current.disabled||e.listboxState===0)return e;let r=e.activeOptionIndex,{isSelected:o}=e.dataRef.current,n=e.options.findIndex(i=>o(i.dataRef.current.value));return n!==-1&&(r=n),{...e,listboxState:0,activeOptionIndex:r}},2(e,r){var o;if(e.dataRef.current.disabled||e.listboxState===1)return e;let n=Y(e),i=ke(r,{resolveItems:()=>n.options,resolveActiveIndex:()=>n.activeOptionIndex,resolveId:c=>c.id,resolveDisabled:c=>c.dataRef.current.disabled});return{...e,...n,searchQuery:"",activeOptionIndex:i,activationTrigger:(o=r.trigger)!=null?o:1}},3:(e,r)=>{if(e.dataRef.current.disabled||e.listboxState===1)return e;let o=e.searchQuery!==""?0:1,n=e.searchQuery+r.value.toLowerCase(),i=(e.activeOptionIndex!==null?e.options.slice(e.activeOptionIndex+o).concat(e.options.slice(0,e.activeOptionIndex+o)):e.options).find(t=>{var l;return!t.dataRef.current.disabled&&((l=t.dataRef.current.textValue)==null?void 0:l.startsWith(n))}),c=i?e.options.indexOf(i):-1;return c===-1||c===e.activeOptionIndex?{...e,searchQuery:n}:{...e,searchQuery:n,activeOptionIndex:c,activationTrigger:1}},4(e){return e.dataRef.current.disabled||e.listboxState===1||e.searchQuery===""?e:{...e,searchQuery:""}},5:(e,r)=>{let o={id:r.id,dataRef:r.dataRef},n=Y(e,i=>[...i,o]);return e.activeOptionIndex===null&&e.dataRef.current.isSelected(r.dataRef.current.value)&&(n.activeOptionIndex=n.options.indexOf(o)),{...e,...n}},6:(e,r)=>{let o=Y(e,n=>{let i=n.findIndex(c=>c.id===r.id);return i!==-1&&n.splice(i,1),n});return{...e,...o,activationTrigger:1}},7:(e,r)=>({...e,labelId:r.id})},_=u.createContext(null);_.displayName="ListboxActionsContext";function U(e){let r=u.useContext(_);if(r===null){let o=new Error(`<${e} /> is missing a parent <Listbox /> component.`);throw Error.captureStackTrace&&Error.captureStackTrace(o,U),o}return r}let ee=u.createContext(null);ee.displayName="ListboxDataContext";function B(e){let r=u.useContext(ee);if(r===null){let o=new Error(`<${e} /> is missing a parent <Listbox /> component.`);throw Error.captureStackTrace&&Error.captureStackTrace(o,B),o}return r}function Je(e,r){return E(r.type,He,e,r)}let Ke=u.Fragment;function Ge(e,r){let{value:o,defaultValue:n,form:i,name:c,onChange:t,by:l=(d,f)=>d===f,disabled:x=!1,horizontal:p=!1,multiple:O=!1,...m}=e;const P=p?"horizontal":"vertical";let I=M(r),[R=O?[]:void 0,v]=Ue(o,t,n),[s,a]=u.useReducer(Je,{dataRef:u.createRef(),listboxState:1,options:[],searchQuery:"",labelId:null,activeOptionIndex:null,activationTrigger:1}),b=u.useRef({static:!1,hold:!1}),T=u.useRef(null),k=u.useRef(null),K=u.useRef(null),L=g(typeof l=="string"?(d,f)=>{let w=l;return(d==null?void 0:d[w])===(f==null?void 0:f[w])}:l),C=u.useCallback(d=>E(h.mode,{1:()=>R.some(f=>L(f,d)),0:()=>L(R,d)}),[R]),h=u.useMemo(()=>({...s,value:R,disabled:x,mode:O?1:0,orientation:P,compare:L,isSelected:C,optionsPropsRef:b,labelRef:T,buttonRef:k,optionsRef:K}),[R,x,O,s]);F(()=>{s.dataRef.current=h},[h]),me([h.buttonRef,h.optionsRef],(d,f)=>{var w;a({type:1}),he(f,Oe.Loose)||(d.preventDefault(),(w=h.buttonRef.current)==null||w.focus())},h.listboxState===0);let oe=u.useMemo(()=>({open:h.listboxState===0,disabled:x,value:R}),[h,x,R]),ie=g(d=>{let f=h.options.find(w=>w.id===d);f&&G(f.dataRef.current.value)}),le=g(()=>{if(h.activeOptionIndex!==null){let{dataRef:d,id:f}=h.options[h.activeOptionIndex];G(d.current.value),a({type:2,focus:$.Specific,id:f})}}),se=g(()=>a({type:0})),ue=g(()=>a({type:1})),ce=g((d,f,w)=>d===$.Specific?a({type:2,focus:$.Specific,id:f,trigger:w}):a({type:2,focus:d,trigger:w})),de=g((d,f)=>(a({type:5,id:d,dataRef:f}),()=>a({type:6,id:d}))),pe=g(d=>(a({type:7,id:d}),()=>a({type:7,id:null}))),G=g(d=>E(h.mode,{0(){return v==null?void 0:v(d)},1(){let f=h.value.slice(),w=f.findIndex(V=>L(V,d));return w===-1?f.push(d):f.splice(w,1),v==null?void 0:v(f)}})),fe=g(d=>a({type:3,value:d})),ve=g(()=>a({type:4})),be=u.useMemo(()=>({onChange:G,registerOption:de,registerLabel:pe,goToOption:ce,closeListbox:ue,openListbox:se,selectActiveOption:le,selectOption:ie,search:fe,clearSearch:ve}),[]),xe={ref:I},Q=u.useRef(null),ge=q();return u.useEffect(()=>{Q.current&&n!==void 0&&ge.addEventListener(Q.current,"reset",()=>{v==null||v(n)})},[Q,v]),W.createElement(_.Provider,{value:be},W.createElement(ee.Provider,{value:h},W.createElement(Re,{value:E(h.listboxState,{0:H.Open,1:H.Closed})},c!=null&&R!=null&&Be({[c]:R}).map(([d,f],w)=>W.createElement(Se,{features:ye.Hidden,ref:w===0?V=>{var te;Q.current=(te=V==null?void 0:V.closest("form"))!=null?te:null}:void 0,...Le({key:d,as:"input",type:"hidden",hidden:!0,readOnly:!0,form:i,name:d,value:f})})),A({ourProps:xe,theirProps:m,slot:oe,defaultTag:Ke,name:"Listbox"}))))}let Xe="button";function Ye(e,r){var o;let n=J(),{id:i=`headlessui-listbox-button-${n}`,...c}=e,t=B("Listbox.Button"),l=U("Listbox.Button"),x=M(t.buttonRef,r),p=q(),O=g(s=>{switch(s.key){case S.Space:case S.Enter:case S.ArrowDown:s.preventDefault(),l.openListbox(),p.nextFrame(()=>{t.value||l.goToOption($.First)});break;case S.ArrowUp:s.preventDefault(),l.openListbox(),p.nextFrame(()=>{t.value||l.goToOption($.Last)});break}}),m=g(s=>{switch(s.key){case S.Space:s.preventDefault();break}}),P=g(s=>{if(Ce(s.currentTarget))return s.preventDefault();t.listboxState===0?(l.closeListbox(),p.nextFrame(()=>{var a;return(a=t.buttonRef.current)==null?void 0:a.focus({preventScroll:!0})})):(s.preventDefault(),l.openListbox())}),I=re(()=>{if(t.labelId)return[t.labelId,i].join(" ")},[t.labelId,i]),R=u.useMemo(()=>({open:t.listboxState===0,disabled:t.disabled,value:t.value}),[t]),v={ref:x,id:i,type:we(e,t.buttonRef),"aria-haspopup":"listbox","aria-controls":(o=t.optionsRef.current)==null?void 0:o.id,"aria-expanded":t.listboxState===0,"aria-labelledby":I,disabled:t.disabled,onKeyDown:O,onKeyUp:m,onClick:P};return A({ourProps:v,theirProps:c,slot:R,defaultTag:Xe,name:"Listbox.Button"})}let Ze="label";function _e(e,r){let o=J(),{id:n=`headlessui-listbox-label-${o}`,...i}=e,c=B("Listbox.Label"),t=U("Listbox.Label"),l=M(c.labelRef,r);F(()=>t.registerLabel(n),[n]);let x=g(()=>{var O;return(O=c.buttonRef.current)==null?void 0:O.focus({preventScroll:!0})}),p=u.useMemo(()=>({open:c.listboxState===0,disabled:c.disabled}),[c]);return A({ourProps:{ref:l,id:n,onClick:x},theirProps:i,slot:p,defaultTag:Ze,name:"Listbox.Label"})}let et="ul",tt=ae.RenderStrategy|ae.Static;function at(e,r){var o;let n=J(),{id:i=`headlessui-listbox-options-${n}`,...c}=e,t=B("Listbox.Options"),l=U("Listbox.Options"),x=M(t.optionsRef,r),p=q(),O=q(),m=Ie(),P=m!==null?(m&H.Open)===H.Open:t.listboxState===0;u.useEffect(()=>{var a;let b=t.optionsRef.current;b&&t.listboxState===0&&b!==((a=$e(b))==null?void 0:a.activeElement)&&b.focus({preventScroll:!0})},[t.listboxState,t.optionsRef]);let I=g(a=>{switch(O.dispose(),a.key){case S.Space:if(t.searchQuery!=="")return a.preventDefault(),a.stopPropagation(),l.search(a.key);case S.Enter:if(a.preventDefault(),a.stopPropagation(),t.activeOptionIndex!==null){let{dataRef:b}=t.options[t.activeOptionIndex];l.onChange(b.current.value)}t.mode===0&&(l.closeListbox(),Z().nextFrame(()=>{var b;return(b=t.buttonRef.current)==null?void 0:b.focus({preventScroll:!0})}));break;case E(t.orientation,{vertical:S.ArrowDown,horizontal:S.ArrowRight}):return a.preventDefault(),a.stopPropagation(),l.goToOption($.Next);case E(t.orientation,{vertical:S.ArrowUp,horizontal:S.ArrowLeft}):return a.preventDefault(),a.stopPropagation(),l.goToOption($.Previous);case S.Home:case S.PageUp:return a.preventDefault(),a.stopPropagation(),l.goToOption($.First);case S.End:case S.PageDown:return a.preventDefault(),a.stopPropagation(),l.goToOption($.Last);case S.Escape:return a.preventDefault(),a.stopPropagation(),l.closeListbox(),p.nextFrame(()=>{var b;return(b=t.buttonRef.current)==null?void 0:b.focus({preventScroll:!0})});case S.Tab:a.preventDefault(),a.stopPropagation();break;default:a.key.length===1&&(l.search(a.key),O.setTimeout(()=>l.clearSearch(),350));break}}),R=re(()=>{var a;return(a=t.buttonRef.current)==null?void 0:a.id},[t.buttonRef.current]),v=u.useMemo(()=>({open:t.listboxState===0}),[t]),s={"aria-activedescendant":t.activeOptionIndex===null||(o=t.options[t.activeOptionIndex])==null?void 0:o.id,"aria-multiselectable":t.mode===1?!0:void 0,"aria-labelledby":R,"aria-orientation":t.orientation,id:i,onKeyDown:I,role:"listbox",tabIndex:0,ref:x};return A({ourProps:s,theirProps:c,slot:v,defaultTag:et,features:tt,visible:P,name:"Listbox.Options"})}let nt="li";function rt(e,r){let o=J(),{id:n=`headlessui-listbox-option-${o}`,disabled:i=!1,value:c,...t}=e,l=B("Listbox.Option"),x=U("Listbox.Option"),p=l.activeOptionIndex!==null?l.options[l.activeOptionIndex].id===n:!1,O=l.isSelected(c),m=u.useRef(null),P=Pe(m),I=ne({disabled:i,value:c,domRef:m,get textValue(){return P()}}),R=M(r,m);F(()=>{if(l.listboxState!==0||!p||l.activationTrigger===0)return;let L=Z();return L.requestAnimationFrame(()=>{var C,h;(h=(C=m.current)==null?void 0:C.scrollIntoView)==null||h.call(C,{block:"nearest"})}),L.dispose},[m,p,l.listboxState,l.activationTrigger,l.activeOptionIndex]),F(()=>x.registerOption(n,I),[I,n]);let v=g(L=>{if(i)return L.preventDefault();x.onChange(c),l.mode===0&&(x.closeListbox(),Z().nextFrame(()=>{var C;return(C=l.buttonRef.current)==null?void 0:C.focus({preventScroll:!0})}))}),s=g(()=>{if(i)return x.goToOption($.Nothing);x.goToOption($.Specific,n)}),a=Te(),b=g(L=>a.update(L)),T=g(L=>{a.wasMoved(L)&&(i||p||x.goToOption($.Specific,n,0))}),k=g(L=>{a.wasMoved(L)&&(i||p&&x.goToOption($.Nothing))}),K=u.useMemo(()=>({active:p,selected:O,disabled:i}),[p,O,i]);return A({ourProps:{id:n,ref:R,role:"option",tabIndex:i===!0?void 0:-1,"aria-disabled":i===!0?!0:void 0,"aria-selected":O,disabled:void 0,onClick:v,onFocus:s,onPointerEnter:b,onMouseEnter:b,onPointerMove:T,onMouseMove:T,onPointerLeave:k,onMouseLeave:k},theirProps:t,slot:K,defaultTag:nt,name:"Listbox.Option"})}let ot=N(Ge),it=N(Ye),lt=N(_e),st=N(at),ut=N(rt),z=Object.assign(ot,{Button:it,Label:lt,Options:st,Option:ut});function ct({title:e,titleId:r,...o},n){return u.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 20 20",fill:"currentColor","aria-hidden":"true","data-slot":"icon",ref:n,"aria-labelledby":r},o),e?u.createElement("title",{id:r},e):null,u.createElement("path",{fillRule:"evenodd",d:"M10.53 3.47a.75.75 0 0 0-1.06 0L6.22 6.72a.75.75 0 0 0 1.06 1.06L10 5.06l2.72 2.72a.75.75 0 1 0 1.06-1.06l-3.25-3.25Zm-4.31 9.81 3.25 3.25a.75.75 0 0 0 1.06 0l3.25-3.25a.75.75 0 1 0-1.06-1.06L10 14.94l-2.72-2.72a.75.75 0 0 0-1.06 1.06Z",clipRule:"evenodd"}))}const dt=u.forwardRef(ct),pt=dt,xt=e=>{const{items:r,renderOption:o,renderValue:n,label:i,className:c,optionToValue:t,multi:l,disabled:x}=e,[p,O]=u.useState(),{field:m,error:P}=De(e),{value:I=l?[]:null}=m;u.useEffect(()=>{let v=I;t&&(D(I)?v=I.map(s=>r.find(a=>t(a)===s)):v=r.find(s=>t(s)===I)),O(v)},[JSON.stringify([I])]);const R=v=>{if(D(v)){const s=Ae(v);O(s),m.onChange({target:{name:m.name,value:t?s.map(t):s}})}else{const s=v;O(s),m.onChange({target:{name:m.name,value:t?t(s):s}})}};return y.jsx(je,{label:i,error:P,className:c,children:y.jsx(z,{disabled:x,children:({open:v})=>y.jsx("div",{className:j("relative"),children:y.jsxs(Fe,{as:"div",className:"relative",offset:4,floatingAs:u.Fragment,portal:!0,adaptiveWidth:!0,autoPlacement:{allowedPlacements:["bottom","top"]},children:[y.jsxs(z.Button,{name:m.name,onBlur:m.onBlur,className:j("relative w-full cursor-pointer rounded-md bg-white py-1.5 pl-3 pr-10 text-left text-gray-900 shadow-sm ring-1 ring-inset ring-gray-300 focus:outline-none focus:ring-2 focus:ring-indigo-500 sm:text-sm sm:leading-6",{"ring-1 rounded-md ring-red-500 focus:ring-red-500":!!P,"!cursor-not-allowed !bg-gray-200":x}),children:[y.jsx("div",{className:"flex items-center h-6",children:p&&(D(p)?p.map((s,a)=>y.jsx(u.Fragment,{children:n(s)},a)):n(p))}),y.jsx("span",{className:"pointer-events-none absolute inset-y-0 right-0 ml-3 flex items-center pr-2",children:y.jsx(pt,{className:"h-5 w-5 text-gray-400","aria-hidden":"true"})})]}),y.jsx(Ne,{show:v,as:u.Fragment,leave:"transition ease-in duration-100",leaveFrom:"opacity-100",leaveTo:"opacity-0",children:y.jsx(z.Options,{className:"absolute z-10 mt-1 max-h-56 w-full overflow-auto rounded-md bg-white py-1 text-base shadow-lg ring-1 ring-black ring-opacity-5 focus:outline-none sm:text-sm",children:r.map((s,a)=>{const b=D(p)?p.find(T=>X(T,s)):X(p,s);return y.jsx(z.Option,{className:({active:T})=>j("text-gray-900 relative select-none cursor-pointer",{"bg-indigo-600 text-white":T}),onClick:T=>{D(p)?(T.preventDefault(),R(b?Me(p,p.findIndex(k=>X(k,s))):[...p,s])):R(b?void 0:s)},value:null,children:()=>y.jsxs("div",{className:j("p-2",{"bg-gray-200":b}),children:[y.jsx("div",{className:"flex items-center ml-3 truncate",children:o(s)}),b&&y.jsx("span",{className:j("bg-inherit absolute inset-y-0 right-0 flex items-center pr-4 text-indigo-600"),children:y.jsx(Qe,{className:"h-5 w-5","aria-hidden":"true"})})]})},a)})})})]})})})})};export{xt as F};
