import{b as d,aE as f,g as u,w as c,j as s,B as p,aF as A,v as m,x as g,r as j,aG as l}from"./index-ih0eSx80.js";import{R as y,T as R,B as v,a as B,g as C}from"./date-Og264Mni.js";import{B as P}from"./index-TYx6HqPn.js";import{L as U}from"./layout-page-section-FVHDwXUT.js";import"./index-WbMGdbre.js";const b=()=>{const e=d();return{getAllAdminUsers:{...f(e[0]),status:e[1],fetch:(a,t={})=>{e[2]({method:"get",url:u({path:"/admin/users"})},t)},reset:e[3]}}},E=({user:e,callAfarResources:a})=>{const{payment:t}=e,{planHistory:o}=t,{pushModal:i}=c(),n=o[o.length-1]||{},r=(h,x)=>s.jsxs("div",{className:"flex justify-between items-center",children:[s.jsx("span",{className:"font-bold text-nowrap mr-2",children:`${h}: `}),s.jsx("span",{className:"text-nowrap text-gray-500",children:`${x}`})]});return s.jsxs("div",{className:"flex flex-col",children:[r("Plan",n.planType),r("Estado",n.status),r("Trial",n.trialMode),r("Código",n.validationPurchaseCode),s.jsx(p,{label:"Editar",className:"mt-4",onClick:()=>i("UpdateUserPlan",{userId:e._id,userPlan:n,callAfarResources:a})})]})},w=()=>{const e=d();return{removeOneAdminUser:{data:e[0],status:e[1],fetch:({id:a},t={})=>{e[2]({method:"delete",url:u({path:"/admin/users/:id",urlParams:{id:a}})},t)},reset:e[3]}}},N=({rowData:e,callAfarResources:a})=>{const{pushModal:t}=c(),o=()=>{t("Confirmation",{useProps:()=>{const{removeOneAdminUser:i}=w(),{onClose:n}=c(),{onCallAfar:r}=m();return{content:s.jsx("div",{children:s.jsx("span",{children:"Seguro que desea eliminar este usuario?"})}),badge:s.jsx(g,{variant:"error"}),primaryBtn:s.jsx(P,{isBusy:i.status.isBusy,onClick:()=>i.fetch({id:e._id},{onAfterSuccess:()=>{n(),r(a)}})})}}},{emergent:!0})};return s.jsx(y,{children:s.jsx(A,{onClick:o})})},H=()=>{const{getAllAdminUsers:e}=b(),a=()=>e.fetch(void 0);return m(l.getAllAdminUsers,a),j.useEffect(()=>{a()},[]),s.jsxs(U,{title:"Usuarios",children:[s.jsx(R,{className:"justify-end mb-2",children:s.jsx(v,{onClick:a,isBusy:e.status.isBusy})}),s.jsx(B,{heads:[null,"Nombre","Email","Validado","Plan Contratado","Fecha de Creación"],getRowProps:t=>{const{name:o,createdAt:i,email:n,validated:r}=t;return{nodes:[s.jsx(N,{rowData:t,callAfarResources:l.getAllAdminUsers},"RowActions"),o,n,`${r}`,s.jsx(E,{user:t,callAfarResources:l.getAllAdminUsers},"PaymentHistory"),C({date:i,showTime:!0})]}},data:e.data})]})};export{H as Users};
