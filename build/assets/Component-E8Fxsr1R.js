import{b as v,g as y,k as B,w as l,f as P,r as F,h as E,j as e,F as N,i as k,B as j,aH as w,aI as R,n as S,aF as I,x as h,aJ as A,G as q,aK as M}from"./index-ih0eSx80.js";import{B as U}from"./index-TYx6HqPn.js";import{I as D,B as G}from"./index-8hchy7Y-.js";const H=()=>{const r=v();return{updateBusinessPostCategories:{data:r[0],status:r[1],fetch:({routeName:o,postCategories:c},u={})=>{r[2]({method:"put",url:y({path:"/business/:routeName/postCategories",urlParams:{routeName:o}}),data:{postCategories:c}},u)},reset:r[3]}}},L=({portal:r})=>{const{business:o,onFetch:c}=B(),{onClose:u}=l(),{routeName:d}=o||{},p=(o==null?void 0:o.postCategories)||[],x=P(),{updateBusinessPostCategories:b}=H(),[s,m]=F.useState(p),{pushModal:f}=l(),C=E();return d?e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"flex",children:[e.jsx(N,{initialValues:{label:""},validate:n=>C(n,[{field:"label",type:"required"},{field:"label",type:"custom",message:"Esa categoría ya existe.",customCb:t=>!s.map(({label:i})=>i).includes(t)}]),onSubmit:()=>{},children:({values:n,isValid:t,resetForm:i})=>e.jsxs("form",{className:"w-full",children:[e.jsx(k,{id:"postCategoryLabel",name:"label",placeholder:'Escriba una nueva categoría, ej. "Productos en oferta", "Recientes", etc"'}),x.getPortal(e.jsx(j,{label:"Agregar categoría",disabled:!t,stopPropagation:!0,onClick:()=>{const{label:a}=n;m(w(s,{label:a,tag:R(a)})),i()},variant:"primary",className:"ml-4"}))]})}),e.jsx("div",{ref:x.ref})]}),e.jsx("div",{className:"flex flex-wrap mt-3 gap-3 border border-gray-300 rounded-md p-3 ",children:s.map((n,t)=>{const{label:i,hidden:a}=n;return e.jsxs("div",{className:S("flex items-center gap-2 border border-gray-400 rounded-md p-2",{"bg-gray-200":a}),children:[i,e.jsx(I,{className:"text-gray-600 hover:text-gray-800 cursor-pointer",onClick:()=>{f("Confirmation",{useProps:()=>{const{onClose:g}=l();return{content:e.jsxs("div",{children:["Al eliminar una categoría estará removiendo esta clasificación de todas las publicaciones de su negocio y es un cambio irreversible. Seguro que desea eliminar la categoría"," ",e.jsx("span",{className:"font-bold",children:i}),"?"]}),badge:e.jsx(h,{variant:"error"}),primaryBtn:e.jsx(U,{label:"Eliminar",onClick:()=>{m(A(s,t)),g()}})}}},{emergent:!0})}}),e.jsx(D,{hidden:a,onClick:()=>{f("Confirmation",{useProps:()=>{const{onClose:g}=l();return{title:`${a?"Mostrar":"Ocultar"} categoría`,content:e.jsx(e.Fragment,{children:a?e.jsx("div",{children:"Usted está mostrando esta categoría y podrá ser usada para filtrar sus publicaciones en la página de su negocio. Desea continuar?"}):e.jsx("div",{children:"Usted está ocultando esta categoría y no será visible en el filtro por categorias en la página de su negocio. Desea continuar?"})}),badge:e.jsx(h,{variant:"info"}),primaryBtn:e.jsx(j,{label:"Continuar",onClick:()=>{m(q(s,{...n,hidden:!a},t)),g()}})}}},{emergent:!0})}})]},t)})}),r.getPortal(e.jsx(G,{disabled:M(s,p),isBusy:b.status.isBusy,onClick:()=>{b.fetch({postCategories:s,routeName:d},{onAfterSuccess:()=>{c({routeName:d}),u()}})}}))]}):e.jsx(e.Fragment,{})};export{L as Component};
